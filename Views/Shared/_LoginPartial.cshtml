@using System.Security.Claims;
@using QueroBar.Models.Data;
@using QueroBar.Models.Entities;
@inject QueroBar.Models.Data.DatabaseContext dbContext


<style>
    .dropdown2 {
        position: relative;
        display: inline-block;
    }

    .dropdown-content2 {
        display: none;
        position: absolute;
        background-color: #f9f9f9;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        padding: 12px 16px;
        z-index: 1;
        left: -80px;
    }

    .dropdown2:hover .dropdown-content2 {
        display: flow;
    }

    .day {
        position: absolute;
        z-index: 1;
        top: -7px;
        background-color: red;
        border-radius: 50%;
        width: 15px;
        height: 15px;
        text-align: center;
        color: white;
        font-size: 9px;
        position: absolute;
        font-weight: bold;
        overflow: hidden;
        text-align: center;
    }

    .active2 {
        color: #3498DB !important;
        cursor: pointer;
    }

        .active2:before {
            position: absolute;
            content: "\e313";
            font-size: 16px;
            top: 50%;
            right: -15px;
            -webkit-transform: translateY(-50%);
            -ms-transform: translateY(-50%);
            transform: translateY(-50%);
            font-family: 'icomoon';
        }

    .hide {
        display: none;
    }

    @@media (max-width: 1024px) {
        .nav-bar-render {
            text-align: right !important;
        }

        .dropdown-content2 {
            left: 0px;
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            padding: 12px 16px;
            z-index: 1;
            text-align: start !important;
        }
    }
</style>

@if (User.Identity.IsAuthenticated)
{
    var userClaims = User.Claims;

    var roleClaim = userClaims.FirstOrDefault(c => c.Type == "OtherProperties");
    string role = roleClaim?.Value;

    var emailClaim = userClaims.FirstOrDefault(c => c.Type == ClaimTypes.NameIdentifier);
    string email = emailClaim?.Value;

    var user = dbContext.Users.Where(x => x.Email == email).FirstOrDefault();

    <div class="col-6 col-xl-2 nav-bar-render" data-aos="fade-down">
        <div class="d-none d-xl-inline-block">
            <ul class="site-menu js-clone-nav ml-auto list-unstyled d-flex  mb-0 " data-class="social">


                <li>
                    <div class="dropdown2">
                        <a class="active2">@user.Name</a>
                        <div class="dropdown-content2">

                            @if(role == "Client")
                            {
                                <a style="width: auto; color: black;"  href="~/Event/Create" class="nav-item nav-link">Criar Evento</a>
                            }

                            @if (role == "Admin")
                            {
                                <a style="width: auto; color: black;" class=" btn btn-link py-0" href="~/Adm/Index">Usuários</a>
                            }
                            <form method="post" asp-controller="Account" asp-action="LogOut">
                                <button type="submit" style="width: auto; color: black;" class=" btn btn-link py-0">Sair</button>
                            </form>
                        </div>

                    </div>



                </li>
            </ul>
        </div>

        <div class="d-inline-block d-xl-none ml-md-0 mr-auto py-3" style="position: relative; top: 3px;"><a href="#" class="site-menu-toggle js-menu-toggle text-black"><span class="icon-menu h3"></span></a></div>

    </div>
}
else
{
    <div class="col-6 col-xl-2 text-right" data-aos="fade-down">
        <div class="d-none d-xl-inline-block">
            <ul class="site-menu js-clone-nav ml-auto list-unstyled d-flex text-right mb-0" data-class="social">
                <li><a asp-controller="Account" asp-action="Login">Login</a></li>
            </ul>
        </div>

        <div class="d-inline-block d-xl-none ml-md-0 mr-auto py-3" style="position: relative; top: 3px;"><a href="#" class="site-menu-toggle js-menu-toggle text-black"><span class="icon-menu h3"></span></a></div>

    </div>
}
